{% extends "layout.html" %}

{% block head %}
    <link rel="stylesheet" type="text/css" href="{{ url_for('static',filename='userprofile.css') }}">
{% endblock %}

{% block title %}
    {{ userinfo.get('displayname') }}'s profile
{% endblock %}

{% block content %}
    {% if userinfo.get('account_share') and userinfo['account_share'].get('shared_to') %}
        {% for user, target_user_id in userinfo['account_share']['shared_to'].items() %}
            <div class="flex" style="display: flex; color: white;">
                <div class="shared-user">{{ user }}</div>
                <a class="delete-shared" data-userid="{{ target_user_id }}" href="#" onclick=deleteShared()>Удалить</a>
            </div>
        {% endfor %}
    {% endif %}
    {% if userinfo.get('cart') %}
        <table>
            <tr>
                <th>Товар</th>
                <th>Количество</th>
                <th>Цена</th>
            </tr>
            {% for title, complexInfo in userinfo['cart']['complex'].items() %}
                <tr>
                    <td>
                        <div class="complexProduct">
                            <div class="complexProductTitle">{{ title }}</div>
                            <div class="complexProductItems">
                                {% for food in complexInfo['foods'] %}
                                    <div class="complexProductItem">
                                        &emsp;&emsp;&emsp;<a href="{{ food.link }}">{{ food.title }}  -  {{ food.price }} &#x20BD;</a>
                                    </div>
                                {% endfor %}
                            </div>
                        </div>
                    </td>
                    <td class="cartItemAmount">{{ complexInfo['amount'] }}</td>
                    <td class="cartItemPrice">{{ complexInfo['price'] *  complexInfo['amount']  }} &#x20BD;</td>
                </tr>
            {% endfor %}
            {% for food in userinfo['cart']['menu'] %}
                <tr>
                    <td>
                        <div class="product">
                            {{ food.title }}
                        </div>
                    </td>
                    <td class="cartItemAmount">{{ food.amount }}</td>
                    <td class="cartItemPrice">{{ food.price * food.amount }} &#x20BD;</td>
                </tr>
            {% endfor %}
        </table>
        <br>
        <div class="dfdfdf">Сумма заказа - {{ userinfo['cart']['sum'] }} &#x20BD;</div>
    {% else %}
    <div class="dfdfdf">Корзина пуста</div>
    {% endif %}
{% endblock %}