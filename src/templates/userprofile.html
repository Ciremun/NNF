{% extends "layout.html" %}

{% block head %}
    <link rel="stylesheet" type="text/css" href="{{ url_for('static',filename='userprofile.css') }}">
{% endblock %}

{% block title %}
    {{ userinfo.get('displayname') }}'s profile
{% endblock %}

{% block content %}
    {% if userinfo.get('account_share') and userinfo['account_share'].get('shared_to') %}
        {% for user, target_user_id in userinfo['account_share']['shared_to'].items() %}
            <div class="shared-list">
                <div class="shared-user">{{ user }}</div>
                <a class="delete-shared" data-userid="{{ target_user_id }}" href="#" onclick=deleteShared()>Удалить</a>
            </div>
        {% endfor %}
    {% endif %}
    <div class="shared-server-date">Время сервера: {{ userinfo.get('server-date') }}</div>
    <div class="add-shared-forms">
        <div class="add-shared-form width200">
            <input type="text" name="add-shared-username" id="add-shared-username" spellcheck="false" maxlength="25" placeholder=" " onkeydown="addSharedEnterKey()">
            <label for="add-shared-username" class="label-name"><span class="content-name">Пользователь</span></label>
        </div>
        <div class="add-shared-form width75">
            <input type="text" name="add-shared-year" id="add-shared-year" spellcheck="false" placeholder=" " onkeydown="addSharedEnterKey()">
            <label for="add-shared-year" class="label-name"><span class="content-name">год</span></label>
        </div>
        <div class="add-shared-form width75">
            <input type="text" name="add-shared-month" id="add-shared-month" spellcheck="false" maxlength="2" placeholder=" " onkeydown="addSharedEnterKey()">
            <label for="add-shared-month" class="label-name"><span class="content-name">месяц</span></label>
        </div>
        <div class="add-shared-form width75">
            <input type="text" name="add-shared-day" id="add-shared-day" spellcheck="false" maxlength="2" placeholder=" " onkeydown="addSharedEnterKey()">
            <label for="add-shared-day" class="label-name"><span class="content-name">день</span></label>
        </div>
        <div class="add-shared-form width75">
            <input type="text" name="add-shared-hour" id="add-shared-hour" spellcheck="false" maxlength="2" placeholder=" " onkeydown="addSharedEnterKey()">
            <label for="add-shared-hour" class="label-name"><span class="content-name">час</span></label>
        </div>
        <div class="add-shared-form width75">
            <input type="text" name="add-shared-minute" id="add-shared-minute" spellcheck="false" maxlength="2" placeholder=" " onkeydown="addSharedEnterKey()">
            <label for="add-shared-minute" class="label-name"><span class="content-name">минута</span></label>
        </div>
        <div class="add-shared-form width75">
            <input type="text" name="add-shared-second" id="add-shared-second" spellcheck="false" maxlength="2" placeholder=" " onkeydown="addSharedEnterKey()">
            <label for="add-shared-second" class="label-name"><span class="content-name">секунда</span></label>
        </div>
    </div>
    <div class="add-shared-submit"><a href="#" onclick="addShared()">Добавить</a></div>
    <div class="add-shared-submit"><a href="#" onclick="addShared(true)">Добавить на неопределенный срок</a></div>
    {% if userinfo.get('cart') %}
        <table>
            <tr>
                <th>Товар</th>
                <th>Количество</th>
                <th>Цена</th>
            </tr>
            {% for title, complexInfo in userinfo['cart']['complex'].items() %}
                <tr>
                    <td>
                        <div class="complexProduct">
                            <div class="complexProductTitle">{{ title }}</div>
                            <div class="complexProductItems">
                                {% for food in complexInfo['foods'] %}
                                    <div class="complexProductItem">
                                        &emsp;&emsp;&emsp;<a href="{{ food.link }}">{{ food.title }}  -  {{ food.price }} &#x20BD;</a>
                                    </div>
                                {% endfor %}
                            </div>
                        </div>
                    </td>
                    <td class="cartItemAmount">{{ complexInfo['amount'] }}</td>
                    <td class="cartItemPrice">{{ complexInfo['price'] *  complexInfo['amount']  }} &#x20BD;</td>
                </tr>
            {% endfor %}
            {% for food in userinfo['cart']['menu'] %}
                <tr>
                    <td>
                        <div class="product">
                            {{ food.title }}
                        </div>
                    </td>
                    <td class="cartItemAmount">{{ food.amount }}</td>
                    <td class="cartItemPrice">{{ food.price * food.amount }} &#x20BD;</td>
                </tr>
            {% endfor %}
        </table>
        <br>
        <div class="dfdfdf">Сумма заказа - {{ userinfo['cart']['sum'] }} &#x20BD;</div>
    {% else %}
    <div class="dfdfdf">Корзина пуста</div>
    {% endif %}
{% endblock %}